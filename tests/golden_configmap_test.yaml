suite: test golden_configmap
templates:
  - golden_configmap.yaml
tests:
  - it: should use default values when they are not set explicitly
    set:
      conjur.applianceUrl: "https://conjur-oss.conjur-oss.svc.cluster.local"
      conjur.ssl.certificateFile: "tests/test-cert.pem"
      authnK8s.authenticatorID: "my-authenticator-id"

    asserts:
      - hasDocuments:
          count: 1
      - isKind:
          of: ConfigMap
      - equal:
          path: metadata.name
          value: authn-k8s-config-map
      - equal:
          path: data.authnK8sClusterRole
          value: conjur-authenticator-cr
      - equal:
         path: data.authnK8sNamespace
         value: NAMESPACE
      - equal:
          path: data.conjurAccount
          value: default
